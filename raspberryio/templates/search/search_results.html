{% extends "base.html" %}

{% load i18n future mezzanine_tags %}
{% load profile_tags %}

{% block meta_title %}{% trans "Search Results" %}{% endblock %}
{% block title %}{% trans "Search Results" %}{% endblock %}

{% block body_id %}search-results{% endblock %}

{% block main %}
    <div class="inner-content">
        <p>
            {% if results.paginator.count == 0 %}
                No results were found {% if search_type != "Everything" %} in {{ search_type }} {% endif %}matching your query: {{ query }}
            {% else %}
                {% with start=results.start_index end=results.end_index total=results.paginator.count %}
                    Showing {{ start }} to {{ end }} of {{ total }} results {% if search_type != "Everything" %} in {{ search_type }} {% endif %}matching your query: {{ query }}
                {% endwith %}
            {% endif %}
        </p>

        <div id="search-results">
            {% for result in results.object_list %}
                <div class="search-result">

                    <h4>

                    {# Search result number #}
                        {{ forloop.counter0|add:results.start_index }})
                        <a href="{{ result.get_absolute_url }}">
                        {# User profile avatar #}
                            {% if result.profile %}
                                {% avatar result.profile 100 %}
                            {% endif %}
                        {# Project image #}
                            {% if result.tldr %}
                                {% if result.featured_photo %}
                                    <img src="{{ MEDIA_URL }}{% thumbnail result.featured_photo.url 100 100 %}" alt="{{ result.title }}" width="100"/>
                                {% else %}
                                    <img src="{{ STATIC_URL }}img/no-featured-photo.png" alt="{{ project.title }}" width="100" />
                                {% endif %}
                            {% endif %}
                        {# Human readable type and title #}
                            {% if search_type == "Everything" %}
                                {{ result.search_classname|capfirst }} - 
                            {% endif %}
                            {{ result }}
                        </a>
                    </h4>
                    {% if result.description %}
                        <p>{{ result.description|truncatewords_html:50|safe }}</p>
                    {% elif result.profile.bio %}
                        <p>{{ result.profile.bio|truncatewords:50 }}</p>
                    {% endif %}
                </div>
            {% endfor %}
        </div>

        {% pagination_for results %}
    </div>
{% endblock %}
